<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>BiCM · MaxEntropyGraphs.jl</title><meta name="title" content="BiCM · MaxEntropyGraphs.jl"/><meta property="og:title" content="BiCM · MaxEntropyGraphs.jl"/><meta property="twitter:title" content="BiCM · MaxEntropyGraphs.jl"/><meta name="description" content="Documentation for MaxEntropyGraphs.jl."/><meta property="og:description" content="Documentation for MaxEntropyGraphs.jl."/><meta property="twitter:description" content="Documentation for MaxEntropyGraphs.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.jpeg" alt="MaxEntropyGraphs.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">MaxEntropyGraphs.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Models</span><ul><li><a class="tocitem" href="../">Overview</a></li><li><a class="tocitem" href="../UBCM/">UBCM</a></li><li><a class="tocitem" href="../DBCM/">DBCM</a></li><li class="is-active"><a class="tocitem" href>BiCM</a><ul class="internal"><li><a class="tocitem" href="#Model-description"><span>Model description</span></a></li><li><a class="tocitem" href="#Creation"><span>Creation</span></a></li><li><a class="tocitem" href="#Obtaining-the-parameters"><span>Obtaining the parameters</span></a></li><li><a class="tocitem" href="#Sampling-the-ensemble"><span>Sampling the ensemble</span></a></li><li><a class="tocitem" href="#Model-comparison"><span>Model comparison</span></a></li><li><a class="tocitem" href="#Counting-network-motifs"><span>Counting network motifs</span></a></li><li><a class="tocitem" href="#Projecting-the-bipartite-network"><span>Projecting the bipartite network</span></a></li></ul></li></ul></li><li><span class="tocitem">Metrics</span><ul><li><a class="tocitem" href="../../metrics/">Overview</a></li><li><a class="tocitem" href="../../exact/">Analytical</a></li><li><a class="tocitem" href="../../simulated/">Simulation</a></li></ul></li><li><a class="tocitem" href="../../GPU/">GPU acceleration</a></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../../API/API/">Shared</a></li><li><a class="tocitem" href="../../API/API_UBCM/">UBCM</a></li><li><a class="tocitem" href="../../API/API_DBCM/">DBCM</a></li><li><a class="tocitem" href="../../API/API_BiCM/">BiCM</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Models</a></li><li class="is-active"><a href>BiCM</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>BiCM</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/B4rtDC/MaxEntropyGraphs.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/B4rtDC/MaxEntropyGraphs.jl/blob/main/docs/src/models/BiCM.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="BiCM"><a class="docs-heading-anchor" href="#BiCM">BiCM</a><a id="BiCM-1"></a><a class="docs-heading-anchor-permalink" href="#BiCM" title="Permalink"></a></h1><h2 id="Model-description"><a class="docs-heading-anchor" href="#Model-description">Model description</a><a id="Model-description-1"></a><a class="docs-heading-anchor-permalink" href="#Model-description" title="Permalink"></a></h2><p>An undirected bipartite network can be described by its biadjacency matrix <span>$B$</span> of size <span>$N \times M$</span> whose generic entry <span>$b_{iα}$</span> is 1 if node <span>$i$</span> belonging to layer ⊥ is linked to node α belonging to layer ⊤ and 0 otherwise. The two sets of nodes (sometimes referred to a layers) are defined as as ⊥ and ⊤. </p><p>The Bipartite Configuration Model (BiCM) is a maximum-entropy null model for undirected bipartite networks.  It is based on the idea of fixing the degree sequences for each set of nodes (layers) of the network.  The model assumes that the edges are unweighted and that the network is simple, i.e., it has no self-loops or multiple edges between the same pair of nodes [<a href="#1">1</a>]. </p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>For the computation we use the bi-adjacency matrix, whereas the current implementation of the BiCM uses a <code>::Graphs.SimpleGraph</code> to construct the models and assesses its bipartiteness using the functionality available in the <code>Graphs.jl</code> package.</p></div></div><p>The parameter vector is defined as <span>$\theta = [\gamma ; \beta]$</span>, where <span>$\gamma$</span> and <span>$\beta$</span> denote the parameters associated with the ⊥ and ⊤ layer respectively. To speed up the computation of the likelihood maximizing parameters,  we use the reduced version of the model where we consider the unique values the degrees in each layer [<a href="#2">2</a>].</p><table><tr><th style="text-align: right">Description</th><th style="text-align: left">Formula</th></tr><tr><td style="text-align: right">Constraints</td><td style="text-align: left"><span>$\begin{cases} \forall i \in \bot:  k_{i}(A^{*}) = \sum_{\alpha \in \top} b^{*}_{i\alpha} \\  \forall \alpha \in \top:  d_{\alpha}(A^{*}) = \sum_{i \in \bot} b^{*}_{i\alpha} \end{cases}$</span></td></tr><tr><td style="text-align: right">Hamiltonian</td><td style="text-align: left"><span>$H(A, \Theta) = H(A, \gamma, \beta) = \sum_{i \in \bot} \gamma_i k_{i}(A) +  \sum_{\alpha \in \top} \beta_\alpha d_{\alpha}(A)$</span></td></tr><tr><td style="text-align: right">Factorized graph probability</td><td style="text-align: left"><span>$P(A | \Theta) = \prod_{i=1}^{N}\prod_{j=1}^{M} p_{i\alpha}^{b_{i\alpha}} (1 - p_{\alpha})^{1-b_{i\alpha}}$</span></td></tr><tr><td style="text-align: right"><span>$\langle p_{i\alpha} \rangle$</span></td><td style="text-align: left"><span>$p_{i\alpha} = \frac{e^{-\gamma_i - \beta_{\alpha}}}{1+e^{-\gamma_i - \beta_{\alpha}}}$</span></td></tr><tr><td style="text-align: right">Log-likelihood</td><td style="text-align: left"><span>$\mathcal{L}(\Theta) = -\sum_{i \in \bot} \gamma_i k_{i}(A) -  \sum_{\alpha \in \top} \beta_{\alpha} d_{\alpha}(A) - \sum_{i \in \bot}  \sum_{\alpha \in \top} \ln \left( 1 + e^{-\gamma_i - \beta_{\alpha}} \right)$</span></td></tr></table><h2 id="Creation"><a class="docs-heading-anchor" href="#Creation">Creation</a><a id="Creation-1"></a><a class="docs-heading-anchor-permalink" href="#Creation" title="Permalink"></a></h2><pre><code class="language-julia hljs">using Graphs
using MaxEntropyGraphs

# define the network
G = corporateclub()

# instantiate a UBCM model
model = BiCM(G)</code></pre><h2 id="Obtaining-the-parameters"><a class="docs-heading-anchor" href="#Obtaining-the-parameters">Obtaining the parameters</a><a id="Obtaining-the-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Obtaining-the-parameters" title="Permalink"></a></h2><pre><code class="language-julia hljs"># solve using default settings
solve_model!(model)</code></pre><h2 id="Sampling-the-ensemble"><a class="docs-heading-anchor" href="#Sampling-the-ensemble">Sampling the ensemble</a><a id="Sampling-the-ensemble-1"></a><a class="docs-heading-anchor-permalink" href="#Sampling-the-ensemble" title="Permalink"></a></h2><pre><code class="language-julia hljs"># generate 10 random instance of the ensemble
rand(model, 10)</code></pre><h2 id="Model-comparison"><a class="docs-heading-anchor" href="#Model-comparison">Model comparison</a><a id="Model-comparison-1"></a><a class="docs-heading-anchor-permalink" href="#Model-comparison" title="Permalink"></a></h2><pre><code class="language-julia hljs"># compute the AIC  
AIC(model)</code></pre><h2 id="Counting-network-motifs"><a class="docs-heading-anchor" href="#Counting-network-motifs">Counting network motifs</a><a id="Counting-network-motifs-1"></a><a class="docs-heading-anchor-permalink" href="#Counting-network-motifs" title="Permalink"></a></h2><pre><code class="language-julia hljs"># Compute the number of expected occurrences of a V-motif between two users
V_motifs(model, 1, 2, layer=:bottom)
# Compute the number of occurrences of a V-motif in the original graph
V_motifs(model.G, model.⊥nodes[1], model.⊥nodes[2])</code></pre><h2 id="Projecting-the-bipartite-network"><a class="docs-heading-anchor" href="#Projecting-the-bipartite-network">Projecting the bipartite network</a><a id="Projecting-the-bipartite-network-1"></a><a class="docs-heading-anchor-permalink" href="#Projecting-the-bipartite-network" title="Permalink"></a></h2><pre><code class="language-julia hljs"># Raw projection of the network
project(model.G, layer=:bottom)
# Obtaining the statistically significant links
project(model, layer=:bottom)</code></pre><p><em>References</em></p><ul>
<li>
<a id="1">[1]</a> 
M. Baltakiene, K. Baltakys, D. Cardamone, F. Parisi, T. Radicioni, M. Torricelli, J. A. van Lidth de Jeude, F. Saracco <!--  author(s) --> 
<em>"Maximum entropy approach to link prediction in bipartite networks"</em> <!--  title --> 
 arXiv preprint arXiv:1805.04307 (2018). <!--  publisher(s) --> 
<a href="https://arxiv.org/abs/1805.04307">https://arxiv.org/abs/1805.04307</a>
</li>
<li>
<a id="2">[2]</a> 
Vallarano, N., Bruno, M., Marchese, E. et al. <!--  author(s) --> 
<em>"Fast and scalable likelihood maximization for Exponential Random Graph Models with local constraints"</em> <!--  title --> 
Sci Rep 11, 15227 (2021) <!--  publisher(s) --> 
<a href="https://doi.org/10.1038/s41598-021-93830-4">https://doi.org/10.1038/s41598-021-93830-4</a>
</li>
<li>
<a id="3">[3]</a> 
F. Saracco, M. J. Straka, R. Di Clemente, A. Gabrielli, G. Caldarelli, and T. Squartini <!--  author(s) --> 
<em>"Inferring monopartite projections of bipartite networks: an entropy-based approach"</em> <!--  title --> 
 New J. Phys. 19, 053022 (2017) <!--  publisher(s) --> 
<a href="http://stacks.iop.org/1367-2630/19/i=5/a=053022">http://stacks.iop.org/1367-2630/19/i=5/a=053022</a>
</li>
</ul>
</article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../DBCM/">« DBCM</a><a class="docs-footer-nextpage" href="../../metrics/">Overview »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Wednesday 10 April 2024 08:44">Wednesday 10 April 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

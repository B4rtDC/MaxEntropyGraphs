<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>DBCM · MaxEntropyGraphs.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.jpeg" alt="MaxEntropyGraphs.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">MaxEntropyGraphs.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Models</span><ul><li><a class="tocitem" href="../">Overview</a></li><li><a class="tocitem" href="../UBCM/">UBCM</a></li><li class="is-active"><a class="tocitem" href>DBCM</a><ul class="internal"><li><a class="tocitem" href="#Model-description"><span>Model description</span></a></li><li><a class="tocitem" href="#Creation"><span>Creation</span></a></li><li><a class="tocitem" href="#Obtaining-the-parameters"><span>Obtaining the parameters</span></a></li><li><a class="tocitem" href="#Sampling-the-ensemble"><span>Sampling the ensemble</span></a></li><li><a class="tocitem" href="#Model-comparison"><span>Model comparison</span></a></li><li><a class="tocitem" href="#Counting-network-motifs"><span>Counting network motifs</span></a></li></ul></li><li><a class="tocitem" href="../BiCM/">BiCM</a></li></ul></li><li><span class="tocitem">Metrics</span><ul><li><a class="tocitem" href="../../metrics/">Overview</a></li><li><a class="tocitem" href="../../exact/">Analytical</a></li><li><a class="tocitem" href="../../simulated/">Simulation</a></li></ul></li><li><a class="tocitem" href="../../GPU/">GPU acceleration</a></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../../API/API/">Shared</a></li><li><a class="tocitem" href="../../API/API_UBCM/">UBCM</a></li><li><a class="tocitem" href="../../API/API_DBCM/">DBCM</a></li><li><a class="tocitem" href="../../API/API_BiCM/">BiCM</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Models</a></li><li class="is-active"><a href>DBCM</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>DBCM</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/B4rtDC/MaxEntropyGraphs.jl/blob/main/docs/src/models/DBCM.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="DCBM"><a class="docs-heading-anchor" href="#DCBM">DCBM</a><a id="DCBM-1"></a><a class="docs-heading-anchor-permalink" href="#DCBM" title="Permalink"></a></h1><h2 id="Model-description"><a class="docs-heading-anchor" href="#Model-description">Model description</a><a id="Model-description-1"></a><a class="docs-heading-anchor-permalink" href="#Model-description" title="Permalink"></a></h2><p>The Directed Binary Configuration Model (DBCM) is a maximum-entropy null model for undirected networks. It is based on the idea of fixing the in- and outdegree sequence of the network, i.e., the number of incoming and outgoing edges incident to each node, and then randomly rewiring the edges while preserving the degree sequence. The model assumes that the edges are unweighted and that the network is simple, i.e., it has no self-loops or multiple edges between the same pair of nodes [<a href="#1">1</a>,<a href="#2">2</a>]. </p><p>We define the parameter vector as <span>$\theta = [\alpha ; \beta]$</span>, where <span>$\alpha$</span> and <span>$\beta$</span> denote the parameters associated with the out- and indegree respectively.</p><table><tr><th style="text-align: right">Description</th><th style="text-align: left">Formula</th></tr><tr><td style="text-align: right">Constraints</td><td style="text-align: left"><span>$\forall i: \begin{cases} k_{i, out}(A^{*}) = \sum_{j=1}^{N} a^{*}_{ij} \\ k_{i, in}(A^{*}) = \sum_{j=1}^{N} a^{*}_{ji} \end{cases}$</span></td></tr><tr><td style="text-align: right">Hamiltonian</td><td style="text-align: left"><span>$H(A, \Theta) = H(A, \alpha, \beta) = \sum_{i=1}^{N} \alpha_i k_{i,out}(A) +  \beta_i k_{i,in}(A)$</span></td></tr><tr><td style="text-align: right">Factorized graph probability</td><td style="text-align: left"><span>$P(A | \Theta) = \prod_{i=1}^{N}\prod_{j=1, j \ne i}^{N} p_{ij}^{a_{ij}} (1 - p_{ij})^{1-a_{ij}}$</span></td></tr><tr><td style="text-align: right"><span>$\langle a_{ij} \rangle$</span></td><td style="text-align: left"><span>$p_{ij} = \frac{e^{-\alpha_i - \beta_j}}{1+e^{-\alpha_i - \beta_j}}$</span></td></tr><tr><td style="text-align: right">Log-likelihood</td><td style="text-align: left"><span>$\mathcal{L}(\Theta) = -\sum_{i=1}^{N} \left[ \alpha_i k_{i,out}(A^{*}) +  \beta_i k_{i,in}(A^{*}) \right] - \sum_{i=1}^{N} \sum_{j=1, j\ne i}^{N} \ln \left( 1+e^{-\alpha_i - \beta_j} \right)$</span></td></tr><tr><td style="text-align: right"><span>$\langle a_{ij}^{2} \rangle$</span></td><td style="text-align: left"><span>$\langle a_{ij} \rangle$</span></td></tr><tr><td style="text-align: right"><span>$\langle a_{ij}a_{ts} \rangle$</span></td><td style="text-align: left"><span>$\langle a_{ij} \rangle \langle a_{ts} \rangle$</span></td></tr><tr><td style="text-align: right"><span>$\sigma^{*}(X)$</span></td><td style="text-align: left"><span>$\sqrt{\sum_{i,j} \left( \sigma^{*}[a_{ij}] \frac{\partial X}{\partial a_{ij}}  \right)^{2}_{A = \langle A^{*} \rangle} + \dots }$</span></td></tr><tr><td style="text-align: right"><span>$\sigma^{*}[a_{ij}]$</span></td><td style="text-align: left"><span>$\frac{\sqrt{e^{-\alpha_i - \beta_j}}}{1+e^{-\alpha_i - \beta_j}}$</span></td></tr></table><h2 id="Creation"><a class="docs-heading-anchor" href="#Creation">Creation</a><a id="Creation-1"></a><a class="docs-heading-anchor-permalink" href="#Creation" title="Permalink"></a></h2><pre><code class="language-julia hljs">using Graphs
using MaxEntropyGraphs

# define the network
G = SimpleDiGraph(rhesus_macaques())

# instantiate a UBCM model
model = DBCM(G)</code></pre><h2 id="Obtaining-the-parameters"><a class="docs-heading-anchor" href="#Obtaining-the-parameters">Obtaining the parameters</a><a id="Obtaining-the-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Obtaining-the-parameters" title="Permalink"></a></h2><pre><code class="language-julia hljs"># solve using default settings
solve_model!(model)</code></pre><h2 id="Sampling-the-ensemble"><a class="docs-heading-anchor" href="#Sampling-the-ensemble">Sampling the ensemble</a><a id="Sampling-the-ensemble-1"></a><a class="docs-heading-anchor-permalink" href="#Sampling-the-ensemble" title="Permalink"></a></h2><pre><code class="language-julia hljs"># generate 10 random instance of the ensemble
rand(model, 10)</code></pre><h2 id="Model-comparison"><a class="docs-heading-anchor" href="#Model-comparison">Model comparison</a><a id="Model-comparison-1"></a><a class="docs-heading-anchor-permalink" href="#Model-comparison" title="Permalink"></a></h2><pre><code class="language-julia hljs"># compute the AIC  
AIC(model)</code></pre><h2 id="Counting-network-motifs"><a class="docs-heading-anchor" href="#Counting-network-motifs">Counting network motifs</a><a id="Counting-network-motifs-1"></a><a class="docs-heading-anchor-permalink" href="#Counting-network-motifs" title="Permalink"></a></h2><p>The count of a specific network motif can be computed by using <code>M{motif_number}</code>. The motif numbers match the patterns shown on the image below. So for example if you want to compute the number of reciprocated triangles, you would use <code>M13(model)</code>.</p><object type="image/png" data=../../assets/directed_motifs.png  alt="Motif image not found" style="width: 100%;" ></object> <p><a href="https://snap-stanford.github.io/cs224w-notes/preliminaries/motifs-and-structral-roles_lecture">source</a></p><pre><code class="language-julia hljs"># Compute the number of occurences of M13
M13(model)</code></pre><p><em>References</em></p><ul>
<li>
<a id="1">[1]</a> 
Squartini, Tiziano and Garlaschelli, Diego. <!--  author(s) --> 
<em>"Maximum-Entropy Networks: Pattern Detection, Network Reconstruction and Graph Combinatorics"</em> <!--  title --> 
Springer-Verlag GmbH; 1st ed. 2017 edition (25 Dec. 2017). <!--  publisher(s) --> 
<a href="https://link.springer.com/book/10.1007/978-3-319-69438-2">https://link.springer.com/book/10.1007/978-3-319-69438-2</a>
</li>
<li>
<a id="2">[2]</a> 
Squartini, Tiziano and Garlaschelli, Diego. <!--  author(s) --> 
<em>"Analytical maximum-likelihood method to detect patterns in real networks"</em> <!--  title --> 
2011 New J. Phys. 13 083001. <!--  publisher(s) --> 
<a href="https://iopscience.iop.org/article/10.1088/1367-2630/13/8/083001">https://iopscience.iop.org/article/10.1088/1367-2630/13/8/083001</a>
</li>
</ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../UBCM/">« UBCM</a><a class="docs-footer-nextpage" href="../BiCM/">BiCM »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Wednesday 15 November 2023 18:06">Wednesday 15 November 2023</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

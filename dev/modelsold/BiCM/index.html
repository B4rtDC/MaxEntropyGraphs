<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>BiCM · MaxEntropyGraphs.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.jpeg" alt="MaxEntropyGraphs.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">MaxEntropyGraphs.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Models</span><ul><li><a class="tocitem" href="../../models/">Overview</a></li><li><a class="tocitem" href="../../models/UBCM/">UBCM</a></li><li><a class="tocitem" href="../../models/UBCM/">DBCM</a></li><li><a class="tocitem" href="../../models/BiCM/">BiCM</a></li></ul></li><li><span class="tocitem">Metrics</span><ul><li><a class="tocitem" href="../../metrics/">Metrics</a></li><li><a class="tocitem" href="../../exact/">Analytical</a></li><li><a class="tocitem" href="../../simulated/">Simulation</a></li></ul></li><li><a class="tocitem" href="../../GPU/">GPU acceleration</a></li><li><a class="tocitem" href="../../API/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>BiCM</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>BiCM</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/B4rtDC/MaxEntropyGraphs.jl/blob/main/docs/src/modelsold/BiCM.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="BiCM"><a class="docs-heading-anchor" href="#BiCM">BiCM</a><a id="BiCM-1"></a><a class="docs-heading-anchor-permalink" href="#BiCM" title="Permalink"></a></h1><h2 id="Model-description"><a class="docs-heading-anchor" href="#Model-description">Model description</a><a id="Model-description-1"></a><a class="docs-heading-anchor-permalink" href="#Model-description" title="Permalink"></a></h2><p>An undirected bipartite network can be described by its biadjacency matrix <span>$B = \left{ b_{i\alpha} \right}_{i,\alpha}$</span> of size <span>$N \times M$</span> whose generic entry <span>$b_{iα}$</span> is 1 if node <span>$i$</span> belonging to layer ⊥ is linked to node α belonging to layer ⊤ and 0 otherwise. The two sets of nodes (sometimes referred to a layers) are defined as as ⊥ and ⊤.  The Bipartite Configuration Model (BiCM) is a maximum-entropy null model for undirected bipartite networks.  It is based on the idea of fixing the degree sequences for each set of nodes (layers) of the network.  The model assumes that the edges are unweighted and that the network is simple, i.e., it has no self-loops or multiple edges between the same pair of nodes [<a href="#1">1</a>]. </p><p>[!NOTE]   For the computation we use the bi-adjacency matrix, whereas the current implementation of the BiCM uses a <code>::Graphs.SimpleGraph</code> to construct the models and assesses its bipartiteness using the functionality available in the <code>Graphs.jl</code> package.</p><p>We define the parameter vector as <span>$\theta = [\gamma ; \beta]$</span>, where <span>$\gamma$</span> and <span>$\beta$</span> denote the parameters associated with the ⊥ and ⊤ layer respectively. To speed up the computation of the likelihood maximising parameters,  we use the reduced version of the model where we consider the unique values the degrees in each layer [<a href="#2">2</a>].</p><table><tr><th style="text-align: right">Description</th><th style="text-align: left">Formula</th></tr><tr><td style="text-align: right">Constraints</td><td style="text-align: left"><span>$\begin{cases} \forall i \in \bot:  k_{i}(A^{*}) = \sum_{\alpha \in \top} b^{*}_{i\alpha} \\  \forall \alpha \in \top:  d_{\alpha}(A^{*}) = \sum_{i \in \bot} b^{*}_{i\alpha} \end{cases}$</span></td></tr><tr><td style="text-align: right">Hamiltonian</td><td style="text-align: left"><span>$H(A, \Theta) = H(A, \gamma, \beta) = \sum_{i \in \bot} \gamma_i k_{i}(A) +  \sum_{\alpha \in \top} \beta_\alpha d_{\alpha}(A)$</span></td></tr><tr><td style="text-align: right">Factorized graph probability</td><td style="text-align: left"><span>$P(A | \Theta) = \prod_{i=1}^{N}\prod_{j=1}^{M} p_{i\alpha}^{b_{i\alpha}} (1 - p_{\alpha})^{1-b_{i\alpha}}$</span></td></tr><tr><td style="text-align: right"><span>$\langle p_{i\alpha} \rangle$</span></td><td style="text-align: left"><span>$p_{i\alpha} = \frac{e^{-\gamma_i - \beta_{\alpha}}}{1+e^{-\gamma_i - \beta_{\alpha}}}$</span></td></tr><tr><td style="text-align: right">Log-likelihood</td><td style="text-align: left"><span>$\mathcal{L}(\Theta) = -\sum_{i \in \bot} \gamma_i k_{i}(A) -  \sum_{\alpha \in \top} \beta_{\alpha} d_{\alpha}(A) - \sum_{i \in \bot}  \sum_{\alpha \in \top} \ln \left( 1 + e^{-\gamma_i - \beta_{\alpha}} \right)$</span></td></tr><tr><td style="text-align: right"><span>$\langle p_{i\alpha}^{2} \rangle$</span></td><td style="text-align: left"><span>$$</span></td></tr><tr><td style="text-align: right"><span>$\langle p_{i\alpha}a_{t\kappa} \rangle$</span></td><td style="text-align: left"><span>$$</span></td></tr><tr><td style="text-align: right"><span>$\sigma^{*}(X)$</span></td><td style="text-align: left"><span>$$</span></td></tr><tr><td style="text-align: right"><span>$\sigma^{*}[p_{i\alpha}]$</span></td><td style="text-align: left"><span>$$</span></td></tr></table><h2 id="Creation"><a class="docs-heading-anchor" href="#Creation">Creation</a><a id="Creation-1"></a><a class="docs-heading-anchor-permalink" href="#Creation" title="Permalink"></a></h2><pre><code class="language-julia hljs">using Graphs
using MaxEntropyGraphs

# define the network
G =

# instantiate a UBCM model
model = BiCM(G)</code></pre><h2 id="Obtaining-the-parameters"><a class="docs-heading-anchor" href="#Obtaining-the-parameters">Obtaining the parameters</a><a id="Obtaining-the-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Obtaining-the-parameters" title="Permalink"></a></h2><pre><code class="language-julia hljs"># solve using default settings
solve_model!(model)</code></pre><h2 id="Sampling-the-ensemble"><a class="docs-heading-anchor" href="#Sampling-the-ensemble">Sampling the ensemble</a><a id="Sampling-the-ensemble-1"></a><a class="docs-heading-anchor-permalink" href="#Sampling-the-ensemble" title="Permalink"></a></h2><pre><code class="language-julia hljs"># generate 10 random instance of the ensemble
rand(model, 10)</code></pre><h2 id="Model-comparison"><a class="docs-heading-anchor" href="#Model-comparison">Model comparison</a><a id="Model-comparison-1"></a><a class="docs-heading-anchor-permalink" href="#Model-comparison" title="Permalink"></a></h2><pre><code class="language-julia hljs"># compute the AIC  
AIC(model)</code></pre><h2 id="Counting-network-motifs"><a class="docs-heading-anchor" href="#Counting-network-motifs">Counting network motifs</a><a id="Counting-network-motifs-1"></a><a class="docs-heading-anchor-permalink" href="#Counting-network-motifs" title="Permalink"></a></h2><pre><code class="language-julia hljs"># Compute the number of occurences of M13
M13(model)</code></pre><p><img src="/docs/src/assets/directed_motifs.png" alt="directed network motifs naming convention"/></p><p><img src="/docs/src/assets/logo.png" alt="logo"/> <img src="/src/assets/directed_motifs.png" alt="directed network motifs naming convention"/> <img src="/assets/directed_motifs.png" alt="directed network motifs naming convention"/> <img src="/directed_motifs.png" alt="directed network motifs naming convention"/></p><p><img src="./assets/logo.jpeg" alt="logo"/> <img src="./docs/src/assets/directed_motifs.jpg" alt="directed network motifs naming convention"/> <img src="./src/assets/directed_motifs.jpg" alt="directed network motifs naming convention"/> <img src="./assets/directed_motifs.jpg" alt="directed network motifs naming convention"/> <img src="./directed_motifs.jpg" alt="directed network motifs naming convention"/> <img src="/assets/logo.jpeg" alt="logo"/> <img src="/docs/src/assets/directed_motifs.jpg" alt="directed network motifs naming convention"/> <img src="/src/assets/directed_motifs.jpg" alt="directed network motifs naming convention"/> <img src="/assets/directed_motifs.jpg" alt="directed network motifs naming convention"/> <img src="/directed_motifs.jpg" alt="directed network motifs naming convention"/></p><p><img src="./assets/logo.png" alt="the logo"/> <img src="./../assets/logo.png" alt="the logo"/> <img src="./../../assets/logo.png" alt="the logo"/> <img src="/assets/logo.png" alt="the logo"/> <img src="/../assets/logo.png" alt="the logo"/> <img src="/../../assets/logo.png" alt="the logo"/></p><object type="image/png+xml" data=../../assets/directed_motifs.png></object><object type="image/png+xml" data=../../src/assets/directed_motifs.png></object><object type="image/png+xml" data=../../docs/src/assets/directed_motifs.png></object><p><em>References</em></p><ul>
<li>
<a id="1">[1]</a> 
M. Baltakiene, K. Baltakys, D. Cardamone, F. Parisi, T. Radicioni, M. Torricelli, J. A. van Lidth de Jeude, F. Saracco <!--  author(s) --> 
<em>"Maximum entropy approach to link prediction in bipartite networks"</em> <!--  title --> 
 arXiv preprint arXiv:1805.04307 (2018). <!--  publisher(s) --> 
<a href="https://arxiv.org/abs/1805.04307">https://arxiv.org/abs/1805.04307</a>
</li>
<li>
<a id="2">[2]</a> 
Vallarano, N., Bruno, M., Marchese, E. et al. <!--  author(s) --> 
<em>"Fast and scalable likelihood maximization for Exponential Random Graph Models with local constraints"</em> <!--  title --> 
Sci Rep 11, 15227 (2021) <!--  publisher(s) --> 
<a href="https://doi.org/10.1038/s41598-021-93830-4">https://doi.org/10.1038/s41598-021-93830-4</a>
</li>
</ul><p>Fast and scalable likelihood maximization for Exponential Random Graph Models with local constraints</p><p>Vallarano, N., Bruno, M., Marchese, E. et al. Fast and scalable likelihood maximization for Exponential Random Graph Models with local constraints. Sci Rep 11, 15227 (2021). https://doi.org/10.1038/s41598-021-93830-4</p></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Friday 29 September 2023 13:04">Friday 29 September 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

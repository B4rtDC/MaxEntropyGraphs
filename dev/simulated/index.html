<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Simulation · MaxEntropyGraphs.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.jpeg" alt="MaxEntropyGraphs.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">MaxEntropyGraphs.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Models</span><ul><li><a class="tocitem" href="../models/">Overview</a></li><li><a class="tocitem" href="../models/UBCM/">UBCM</a></li><li><a class="tocitem" href="../models/DBCM/">DBCM</a></li><li><a class="tocitem" href="../models/BiCM/">BiCM</a></li></ul></li><li><span class="tocitem">Metrics</span><ul><li><a class="tocitem" href="../metrics/">Overview</a></li><li><a class="tocitem" href="../exact/">Analytical</a></li><li class="is-active"><a class="tocitem" href>Simulation</a><ul class="internal"><li><a class="tocitem" href="#Examples"><span>Examples</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../GPU/">GPU acceleration</a></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../API/API/">Shared</a></li><li><a class="tocitem" href="../API/API_UBCM/">UBCM</a></li><li><a class="tocitem" href="../API/API_DBCM/">DBCM</a></li><li><a class="tocitem" href="../API/API_BiCM/">BiCM</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Metrics</a></li><li class="is-active"><a href>Simulation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Simulation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/B4rtDC/MaxEntropyGraphs.jl/blob/main/docs/src/simulated.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Simulation"><a class="docs-heading-anchor" href="#Simulation">Simulation</a><a id="Simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Simulation" title="Permalink"></a></h1><p>The analytical method can quickly become expensive to compute since each element in the adjacency matrix has a non-zero value. It is also possible to obtain an estimate of both the metric and its standard deviation by generating a large number of random graphs from the ensemble and by computing the value of the metric(s) for each graph. This can also allow you to compute the z-scores of the metric, but some caution is advised. Using the analytical method, we do consider the actual underlying distribution of the metric to combine the expected value and standard deviation. This contrasts with the sample, where we simply apply the mean and standard deviation to the vector of computed metrics. Also, considering the z-score and interpreting statistical significance if <span>$|z| \ge 3$</span> implies that the underlying distribution of the metric follows a standard normal distribution, which is not always the case.</p><h2 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h2><p>Some examples using built-in function of package are listed below:</p><ul><li><a href="#Assortativity_simulation">Assortativity in the UBCM</a></li><li><a href="#Motif_simulation">Motif significance in the DBCM</a></li><li><a href="#BiCM_Vmotifs_simulation">Significance of V-motifs and projection in the BiCM</a></li></ul><h3 id="Assortativity_simulation"><a class="docs-heading-anchor" href="#Assortativity_simulation">Assortativity in the UBCM</a><a id="Assortativity_simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Assortativity_simulation" title="Permalink"></a></h3><p>Let us consider the UBCM applied to the Zachary Karate Club network. We want to analyze if the assortativity of each node (measured by its ANND) is statistically significant from what one would expect under the null model.</p><p>First, we define the network and the associated UBCM model.</p><pre><code class="language-julia hljs">using Graphs
using MaxEntropyGraphs

# define the network
G = MaxEntropyGraphs.Graphs.SimpleGraphs.smallgraph(:karate)
# generate a UBCM model from the karate club network
model = UBCM(G); 
# compute the maximum likelihood parameters
solve_model!(model); 
# compute and set the expected adjacency matrix
set_Ĝ!(model); 
# compute and set the standard deviation of the adjacency matrix
set_σ!(model); 
nothing</code></pre><h3 id="Motif_simulation"><a class="docs-heading-anchor" href="#Motif_simulation">Motif significance in the DBCM</a><a id="Motif_simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Motif_simulation" title="Permalink"></a></h3><p>Let us consider the DBCM applied to the Chesapeake Bay foodweb. We want to analyze if any of the different network motifs is statistically significant of what one would expect under the null model. We want to know the values of <code>M1</code>, ..., <code>M13</code>. These are network-wide measures. </p><p>First, we define the network and the associated UBCM model.</p><pre><code class="language-julia hljs">using Graphs
using MaxEntropyGraphs
import Statistics: mean, std

# define the network
G = chesapeakebay();
# extract its adjacency matrix
A = adjacency_matrix(G);
# generate a UBCM model from the karate club network
model = DBCM(G); 
# compute the maximum likelihood parameters
solve_model!(model); 
# compute and set the expected adjacency matrix
set_Ĝ!(model); 
# compute and set the standard deviation of the adjacency matrix
set_σ!(model); 
# compute the observed motif counts
motifs_observed = [@eval begin $(f)(A) end for f in MaxEntropyGraphs.directed_graph_motif_function_names];
nothing</code></pre><p>Now we need to generate a sample from the network ensemble so that we can compute the sample mean and standard deviation for each motif.</p><pre><code class="language-julia hljs"># Get sample adjacency matrix
S = adjacency_matrix.(rand(model, 100));
# compute the motifs
motif_counts_S = hcat(map(s -&gt; [@eval begin $(f)($s) end for f in MaxEntropyGraphs.directed_graph_motif_function_names], S)...);
# compute the sample mean and standard deviation
motifs_mean_S = reshape(mean(motif_counts_S, dims=2),:);
motifs_std_S = reshape(std(motif_counts_S, dims=2),:);
# compute the z-score
motifs_z_S = (motifs_observed .- motifs_mean_S) ./ motifs_std_S;
nothing</code></pre><h3 id="BiCM_Vmotifs_simulation"><a class="docs-heading-anchor" href="#BiCM_Vmotifs_simulation">Significance of V-motifs and projection in the BiCM</a><a id="BiCM_Vmotifs_simulation-1"></a><a class="docs-heading-anchor-permalink" href="#BiCM_Vmotifs_simulation" title="Permalink"></a></h3><p>Let us consider the BiCM applied to the <a href="http://konect.cc/networks/brunson_club-membership/">corporate club membership network</a>. This bipartite network is composed of 25 persons and 15 social organizations. An edge between a person and a social organization shows that the person is a member. We want to obtain the projection of this network on both the person and the social organization layer. We also want to determine if any of these connections in the projected networks are statistically significant under the BiCM null model. This is done by evaluating if the number of organizations that two users have in common is more than what one would expect under the null model.</p><p>First, we define the network and obtain its weighted projection. This tells us how often a specific connection was observed the real network.</p><pre><code class="language-julia hljs">using MaxEntropyGraphs
using Graphs
using MultipleTesting

# define the network
G = corporateclub();
# project the model on its layers
G_persons, G_organizations = project(G, layer=:bottom, method=:weighted), project(G, layer=:top, method=:weighted);</code></pre><p>We then define a BiCM, compute its likelihood maximizing parameters, generate a sample and the projections of the sample</p><pre><code class="language-julia hljs"># generate a BiCM from the corporate club network
model = BiCM(G); 
# compute the maximum likelihood parameters
solve_model!(model); 
# sample
S = rand(model, 100);
# projected samples
S_persons, S_organizations = project.(S, layer=:bottom, method=:weighted), project.(S, layer=:bottom, method=:weighted)</code></pre><p>For each edge in the original network, we can now compare how its weight compares to the distribution of weights in the random sample and determine their empirical p-values.</p><pre><code class="language-julia hljs"># determine the empirical pvalues
p = zeros(length(edges(G_persons)))
for (i,e) in enumerate(edges(G_persons))
    e_w   = e.weight
    e_w_s = map(s -&gt; s.weights[e.src, e.dst], S_persons)
    p[i] = (sum(e_w_s .&gt; e_w) + 1) / (length(e_w_s) + 1)
end
# correct p-values for multiple testing
p_corrected = adjust(p, BenjaminiHochberg())
# get significant edges
filter(x -&gt; x[1] &lt; α, collect(zip(p_corrected, edges(G_persons))))

# output
Tuple{Float64, SimpleWeightedGraphs.SimpleWeightedEdge{Int64, Int64}}[]</code></pre><p>We come to the conclusion that there are no statistically significant edges in the projected network. This is the same conclusions that was obtained by using <code>project(model)</code> directly.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../exact/">« Analytical</a><a class="docs-footer-nextpage" href="../GPU/">GPU acceleration »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Friday 8 March 2024 13:08">Friday 8 March 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>UBCM · MaxEntropyGraphs.jl</title><meta name="title" content="UBCM · MaxEntropyGraphs.jl"/><meta property="og:title" content="UBCM · MaxEntropyGraphs.jl"/><meta property="twitter:title" content="UBCM · MaxEntropyGraphs.jl"/><meta name="description" content="Documentation for MaxEntropyGraphs.jl."/><meta property="og:description" content="Documentation for MaxEntropyGraphs.jl."/><meta property="twitter:description" content="Documentation for MaxEntropyGraphs.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.jpeg" alt="MaxEntropyGraphs.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">MaxEntropyGraphs.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Models</span><ul><li><a class="tocitem" href="../../models/">Overview</a></li><li><a class="tocitem" href="../../models/UBCM/">UBCM</a></li><li><a class="tocitem" href="../../models/DBCM/">DBCM</a></li><li><a class="tocitem" href="../../models/BiCM/">BiCM</a></li></ul></li><li><span class="tocitem">Metrics</span><ul><li><a class="tocitem" href="../../metrics/">Overview</a></li><li><a class="tocitem" href="../../exact/">Analytical</a></li><li><a class="tocitem" href="../../simulated/">Simulation</a></li></ul></li><li><a class="tocitem" href="../../GPU/">GPU acceleration</a></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../API/">Shared</a></li><li class="is-active"><a class="tocitem" href>UBCM</a><ul class="internal"><li><a class="tocitem" href="#Index"><span>Index</span></a></li></ul></li><li><a class="tocitem" href="../API_DBCM/">DBCM</a></li><li><a class="tocitem" href="../API_BiCM/">BiCM</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API</a></li><li class="is-active"><a href>UBCM</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>UBCM</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/B4rtDC/MaxEntropyGraphs.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/B4rtDC/MaxEntropyGraphs.jl/blob/main/docs/src/API/API_UBCM.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="#MaxEntropyGraphs.UBCM"><code>MaxEntropyGraphs.UBCM</code></a></li><li><a href="#MaxEntropyGraphs.UBCM-Tuple{T} where T"><code>MaxEntropyGraphs.UBCM</code></a></li><li><a href="#Base.length-Tuple{UBCM}"><code>Base.length</code></a></li><li><a href="#Base.precision-Tuple{UBCM}"><code>Base.precision</code></a></li><li><a href="#Base.rand-Tuple{UBCM}"><code>Base.rand</code></a></li><li><a href="#Base.rand-Tuple{UBCM, Int64}"><code>Base.rand</code></a></li><li><a href="#MaxEntropyGraphs.A-Tuple{UBCM, Int64, Int64}"><code>MaxEntropyGraphs.A</code></a></li><li><a href="#MaxEntropyGraphs.AIC-Tuple{UBCM}"><code>MaxEntropyGraphs.AIC</code></a></li><li><a href="#MaxEntropyGraphs.AICc-Tuple{UBCM}"><code>MaxEntropyGraphs.AICc</code></a></li><li><a href="#MaxEntropyGraphs.BIC-Tuple{UBCM}"><code>MaxEntropyGraphs.BIC</code></a></li><li><a href="#MaxEntropyGraphs.L_UBCM_reduced"><code>MaxEntropyGraphs.L_UBCM_reduced</code></a></li><li><a href="#MaxEntropyGraphs.UBCM_reduced_iter!"><code>MaxEntropyGraphs.UBCM_reduced_iter!</code></a></li><li><a href="#MaxEntropyGraphs.f_UBCM-Tuple{UBCM}"><code>MaxEntropyGraphs.f_UBCM</code></a></li><li><a href="#MaxEntropyGraphs.initial_guess-Tuple{UBCM}"><code>MaxEntropyGraphs.initial_guess</code></a></li><li><a href="#MaxEntropyGraphs.set_xᵣ!-Tuple{UBCM}"><code>MaxEntropyGraphs.set_xᵣ!</code></a></li><li><a href="#MaxEntropyGraphs.set_Ĝ!-Tuple{UBCM}"><code>MaxEntropyGraphs.set_Ĝ!</code></a></li><li><a href="#MaxEntropyGraphs.set_σ!-Tuple{UBCM}"><code>MaxEntropyGraphs.set_σ!</code></a></li><li><a href="#MaxEntropyGraphs.solve_model!-Tuple{UBCM}"><code>MaxEntropyGraphs.solve_model!</code></a></li><li><a href="#MaxEntropyGraphs.Ĝ-Tuple{UBCM}"><code>MaxEntropyGraphs.Ĝ</code></a></li><li><a href="#MaxEntropyGraphs.σˣ-Tuple{UBCM}"><code>MaxEntropyGraphs.σˣ</code></a></li><li><a href="#MaxEntropyGraphs.σₓ-Tuple{UBCM, Function}"><code>MaxEntropyGraphs.σₓ</code></a></li><li><a href="#MaxEntropyGraphs.∇L_UBCM_reduced!"><code>MaxEntropyGraphs.∇L_UBCM_reduced!</code></a></li><li><a href="#MaxEntropyGraphs.∇L_UBCM_reduced_minus!"><code>MaxEntropyGraphs.∇L_UBCM_reduced_minus!</code></a></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MaxEntropyGraphs.UBCM" href="#MaxEntropyGraphs.UBCM"><code>MaxEntropyGraphs.UBCM</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">UBCM</code></pre><p>Maximum entropy model for the Undirected Binary Configuration Model (UBCM). </p><p>The object holds the maximum likelihood parameters of the model (θ) and optionally the expected adjacency matrix (G),  and the variance for the elements of the adjacency matrix (σ). All settings and other metadata are stored in the <code>status</code> field.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/B4rtDC/MaxEntropyGraphs.jl/blob/7880474ed4b5160f482e74ad34aeca954766825e/src/Models/UBCM.jl#L2-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MaxEntropyGraphs.UBCM-Tuple{T} where T" href="#MaxEntropyGraphs.UBCM-Tuple{T} where T"><code>MaxEntropyGraphs.UBCM</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">UBCM(G::T; d::Vector=Graphs.degree(G), precision::N=Float64, kwargs...) where {T&lt;:Graphs.AbstractGraph, N&lt;:Real}
UBCM(d::Vector{T}, precision::Type{&lt;:AbstractFloat}=Float64, kwargs...)</code></pre><p>Constructor function for the <code>UBCM</code> type. </p><p>By default and dependng on the graph type <code>T</code>, the definition of degree from <code>Graphs.jl</code> is applied.  If you want to use a different definition of degree, you can pass a vector of degrees as the second argument. If you want to generate a model directly from a degree sequence without an underlying graph, you can simply pass the degree sequence as an argument. If you want to work from an adjacency matrix, or edge list, you can use the graph constructors from the <code>JuliaGraphs</code> ecosystem.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs"># generating a model from a graph
julia&gt; G = MaxEntropyGraphs.Graphs.SimpleGraphs.smallgraph(:karate)
{34, 78} undirected simple Int64 graph
julia&gt; model = UBCM(G)
UBCM{Graphs.SimpleGraphs.SimpleGraph{Int64}, Float64} (34 vertices, 11 unique degrees, 0.32 compression ratio)</code></pre><pre><code class="language-julia-repl hljs"># generating a model directly from a degree sequence
julia&gt; model = UBCM(d=[4;3;3;3;2])
UBCM{Nothing, Float64} (5 vertices, 3 unique degrees, 0.60 compression ratio)</code></pre><pre><code class="language-julia-repl hljs"># generating a model directly from a degree sequence with a different precision
julia&gt; model = UBCM(d=[4;3;3;3;2], precision=Float16)
UBCM{Nothing, Float16} (5 vertices, 3 unique degrees, 0.60 compression ratio)</code></pre><pre><code class="language-julia-repl hljs"># generating a model from an adjacency matrix
julia&gt; A = [0 1 1;1 0 0;1 0 0];

julia&gt; G = MaxEntropyGraphs.Graphs.SimpleGraph(A)
{3, 2} undirected simple Int64 graph
julia&gt; model = UBCM(G)
UBCM{Graphs.SimpleGraphs.SimpleGraph{Int64}, Float64} (3 vertices, 2 unique degrees, 0.67 compression ratio)</code></pre><pre><code class="language-julia-repl hljs"># generating a model from an edge list
julia&gt; E = [(1,2),(1,3),(2,3)];

julia&gt; edgelist = [MaxEntropyGraphs.Graphs.Edge(x,y) for (x,y) in E];

julia&gt; G = MaxEntropyGraphs.Graphs.SimpleGraphFromIterator(edgelist)
{3, 3} undirected simple Int64 graph
julia&gt; model = UBCM(G)
UBCM{Graphs.SimpleGraphs.SimpleGraph{Int64}, Float64} (3 vertices, 1 unique degrees, 0.33 compression ratio)</code></pre><p>See also <a href="https://juliagraphs.org/Graphs.jl/stable/core_functions/core/#Graphs.degree"><code>Graphs.degree</code></a>, <a href="https://juliagraphs.org/SimpleWeightedGraphs.jl/stable/api/#Graphs.inneighbors-Tuple{SimpleWeightedDiGraph,%20Integer}"><code>SimpleWeightedGraphs.inneighbors</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/B4rtDC/MaxEntropyGraphs.jl/blob/7880474ed4b5160f482e74ad34aeca954766825e/src/Models/UBCM.jl#L44-L95">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MaxEntropyGraphs.solve_model!-Tuple{UBCM}" href="#MaxEntropyGraphs.solve_model!-Tuple{UBCM}"><code>MaxEntropyGraphs.solve_model!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">solve_model!(m::UBCM; kwargs...)</code></pre><p>Compute the likelihood maximising parameters of the UBCM model <code>m</code>. </p><p><strong>Arguments</strong></p><ul><li><code>method::Symbol</code>: solution method to use, can be <code>:fixedpoint</code> (default), or :NelderMead, :BFGS, :LBFGS and :Newton.</li><li><code>initial::Symbol</code>: initial guess for the parameters <span>$\Theta$</span>, can be :degrees, :degrees<em>minor, :random, :uniform, or :chung</em>lu.</li><li><code>maxiters::Int</code>: maximum number of iterations for the solver (defaults to 1000). </li><li><code>verbose::Bool</code>: set to show log messages (defaults to false).</li><li><code>ftol::Real</code>: function tolerance for convergence with the fixedpoint method (defaults to 1e-8).</li><li><code>abstol::Union{Number, Nothing}</code>: absolute function tolerance for convergence with the other methods (defaults to <code>nothing</code>).</li><li><code>reltol::Union{Number, Nothing}</code>: relative function tolerance for convergence with the other methods (defaults to <code>nothing</code>).</li><li><code>AD_method::Symbol</code>: autodiff method to use, can be any of :AutoZygote, :AutoReverseDiff, :AutoForwardDiff and :AutoFiniteDiff. Performance depends on the size of the problem (defaults to <code>:AutoZygote</code>),</li><li><code>analytical_gradient::Bool</code>: set the use the analytical gradient instead of the one generated with autodiff (defaults to <code>false</code>)</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs"># default use
julia&gt; model = UBCM(MaxEntropyGraphs.Graphs.SimpleGraphs.smallgraph(:karate));

julia&gt; solve_model!(model);
</code></pre><pre><code class="language-julia-repl hljs"># using analytical gradient and degrees minor initial guess
julia&gt; solve_model!(model, method=:BFGS, analytical_gradient=true, initial=:degrees_minor)
(UBCM{Graphs.SimpleGraphs.SimpleGraph{Int64}, Float64} (34 vertices, 11 unique degrees, 0.32 compression ratio), retcode: Success
u: [2.851659905903854, 2.053008374573552, 1.5432639513870743, 1.152360118212239, 0.8271267490690292, 0.5445045274064909, -0.1398726818076551, -0.3293252270659469, -0.6706207459338859, -1.2685575582149227, -1.410096540372487]
Final objective value:     168.68325136302835
)
</code></pre><p>See also: <a href="#MaxEntropyGraphs.initial_guess-Tuple{UBCM}"><code>initial_guess</code></a>, <a href="#MaxEntropyGraphs.∇L_UBCM_reduced!"><code>∇L_UBCM_reduced!</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/B4rtDC/MaxEntropyGraphs.jl/blob/7880474ed4b5160f482e74ad34aeca954766825e/src/Models/UBCM.jl#L631-L666">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MaxEntropyGraphs.initial_guess-Tuple{UBCM}" href="#MaxEntropyGraphs.initial_guess-Tuple{UBCM}"><code>MaxEntropyGraphs.initial_guess</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initial_guess(m::UBCM, method::Symbol=:degrees)</code></pre><p>Compute an initial guess for the maximum likelihood parameters of the UBCM model <code>m</code> using the method <code>method</code>.</p><p>The methods available are: </p><ul><li><code>:degrees</code> (default): the initial guess is computed using the degrees of the graph, i.e. <span>$\theta_{i} = -\log(d_{i})$</span> </li><li><code>:degrees_minor</code>: the initial guess is computed using the degrees of the graph and the number of edges, i.e. <span>$\theta_{i} = -\log(d_{i}/(\sqrt{E} + 1))$</span></li><li><code>:random</code>: the initial guess is computed using random values between 0 and 1, i.e. <span>$\theta_{i} = -\log(r_{i})$</span> where <span>$r_{i} \sim U(0,1)$</span></li><li><code>:uniform</code>: the initial guess is uniformily set to 0.5, i.e. <span>$\theta_{i} = -\log(0.5)$</span></li><li><code>:chung_lu</code>: the initial guess is computed using the degrees of the graph and the number of edges, i.e. <span>$\theta_{i} = -\log(d_{i}/(2E))$</span></li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; model = UBCM(MaxEntropyGraphs.Graphs.SimpleGraphs.smallgraph(:karate));

julia&gt; initial_guess(model, method=:random);

julia&gt; initial_guess(model, method=:uniform);

julia&gt; initial_guess(model, method=:degrees_minor);

julia&gt; initial_guess(model, method=:chung_lu);

julia&gt; initial_guess(model)
11-element Vector{Float64}:
 -0.0
 -0.6931471805599453
 -1.0986122886681098
 -1.3862943611198906
 -1.6094379124341003
 -1.791759469228055
 -2.1972245773362196
 -2.302585092994046
 -2.4849066497880004
 -2.772588722239781
 -2.833213344056216
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/B4rtDC/MaxEntropyGraphs.jl/blob/7880474ed4b5160f482e74ad34aeca954766825e/src/Models/UBCM.jl#L401-L440">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.rand-Tuple{UBCM}" href="#Base.rand-Tuple{UBCM}"><code>Base.rand</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">rand(m::UBCM; precomputed=false)</code></pre><p>Generate a random graph from the UBCM model <code>m</code>.</p><p><strong>Arguments</strong></p><ul><li><code>precomputed::Bool</code>: if <code>true</code>, the precomputed expected adjacency matrix (<code>m.Ĝ</code>) is used to generate the random graph, otherwise the maximum likelihood parameters are used to generate the random graph on the fly. For larger networks, it is  recommended to not precompute the expected adjacency matrix to limit memory pressure.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; model = UBCM(MaxEntropyGraphs.Graphs.SimpleGraphs.smallgraph(:karate)); # generate a UBCM model from the karate club network

julia&gt; solve_model!(model); # compute the maximum likelihood parameters

julia&gt; sample = rand(model); # sample a random graph

julia&gt; typeof(sample)
Graphs.SimpleGraphs.SimpleGraph{Int64}</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/B4rtDC/MaxEntropyGraphs.jl/blob/7880474ed4b5160f482e74ad34aeca954766825e/src/Models/UBCM.jl#L553-L573">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.rand-Tuple{UBCM, Int64}" href="#Base.rand-Tuple{UBCM, Int64}"><code>Base.rand</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">rand(m::UBCM, n::Int; precomputed=false)</code></pre><p>Generate <code>n</code> random graphs from the UBCM model <code>m</code>. If multithreading is available, the graphs are generated in parallel.</p><p><strong>Arguments</strong></p><ul><li><code>precomputed::Bool</code>: if <code>true</code>, the precomputed expected adjacency matrix (<code>m.Ĝ</code>) is used to generate the random graph, otherwise the maximum likelihood parameters are used to generate the random graph on the fly. For larger networks, it is  recommended to not precompute the expected adjacency matrix to limit memory pressure.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; model = UBCM(MaxEntropyGraphs.Graphs.SimpleGraphs.smallgraph(:karate)); # generate a UBCM model from the karate club network

julia&gt; solve_model!(model); # compute the maximum likelihood parameters

julia&gt; sample = rand(model, 10); # sample a set of random graphs

julia&gt; typeof(sample)
Vector{SimpleGraph{Int64}} (alias for Array{Graphs.SimpleGraphs.SimpleGraph{Int64}, 1})</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/B4rtDC/MaxEntropyGraphs.jl/blob/7880474ed4b5160f482e74ad34aeca954766825e/src/Models/UBCM.jl#L598-L618">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MaxEntropyGraphs.AIC-Tuple{UBCM}" href="#MaxEntropyGraphs.AIC-Tuple{UBCM}"><code>MaxEntropyGraphs.AIC</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">AIC(m::UBCM)</code></pre><p>Compute the Akaike Information Criterion (AIC) for the UBCM model <code>m</code>. The parameters of the models most be computed beforehand.  If the number of empirical observations becomes too small with respect to the number of parameters, you will get a warning. In  that case, the corrected AIC (AICc) should be used instead.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">julia&gt; model = UBCM(MaxEntropyGraphs.Graphs.SimpleGraphs.smallgraph(:karate));

julia&gt; solve_model!(model);

julia&gt; AIC(model);
[...]
</code></pre><p>See also <a href="../API_BiCM/#MaxEntropyGraphs.AICc-Tuple{BiCM}"><code>AICc</code></a>, <a href="#MaxEntropyGraphs.L_UBCM_reduced"><code>L_UBCM_reduced</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/B4rtDC/MaxEntropyGraphs.jl/blob/7880474ed4b5160f482e74ad34aeca954766825e/src/Models/UBCM.jl#L863-L882">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MaxEntropyGraphs.AICc-Tuple{UBCM}" href="#MaxEntropyGraphs.AICc-Tuple{UBCM}"><code>MaxEntropyGraphs.AICc</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">AICc(m::UBCM)</code></pre><p>Compute the corrected Akaike Information Criterion (AICc) for the UBCM model <code>m</code>. The parameters of the models most be computed beforehand. </p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; model = UBCM(MaxEntropyGraphs.Graphs.SimpleGraphs.smallgraph(:karate));

julia&gt; solve_model!(model);

julia&gt; AICc(model)
409.891217554954
</code></pre><p>See also <a href="../API_BiCM/#MaxEntropyGraphs.AIC-Tuple{BiCM}"><code>AIC</code></a>, <a href="#MaxEntropyGraphs.L_UBCM_reduced"><code>L_UBCM_reduced</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/B4rtDC/MaxEntropyGraphs.jl/blob/7880474ed4b5160f482e74ad34aeca954766825e/src/Models/UBCM.jl#L899-L917">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MaxEntropyGraphs.BIC-Tuple{UBCM}" href="#MaxEntropyGraphs.BIC-Tuple{UBCM}"><code>MaxEntropyGraphs.BIC</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">BIC(m::UBCM)</code></pre><p>Compute the Bayesian Information Criterion (BIC) for the UBCM model <code>m</code>. The parameters of the models most be computed beforehand.  BIC is believed to be more restrictive than AIC, as the former favors models with a lower number of parameters than those favored by the latter.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; model = UBCM(MaxEntropyGraphs.Graphs.SimpleGraphs.smallgraph(:karate));

julia&gt; solve_model!(model);

julia&gt; BIC(model)
552.5770135138283
</code></pre><p>See also <a href="../API_BiCM/#MaxEntropyGraphs.AIC-Tuple{BiCM}"><code>AIC</code></a>, <a href="#MaxEntropyGraphs.L_UBCM_reduced"><code>L_UBCM_reduced</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/B4rtDC/MaxEntropyGraphs.jl/blob/7880474ed4b5160f482e74ad34aeca954766825e/src/Models/UBCM.jl#L930-L948">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.length-Tuple{UBCM}" href="#Base.length-Tuple{UBCM}"><code>Base.length</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Return the reduced number of nodes in the UBCM network</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/B4rtDC/MaxEntropyGraphs.jl/blob/7880474ed4b5160f482e74ad34aeca954766825e/src/Models/UBCM.jl#L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MaxEntropyGraphs.L_UBCM_reduced" href="#MaxEntropyGraphs.L_UBCM_reduced"><code>MaxEntropyGraphs.L_UBCM_reduced</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">L_UBCM_reduced(θ::Vector, K::Vector, F::Vector)</code></pre><p>Compute the log-likelihood of the reduced UBCM model using the exponential formulation in order to maintain convexity.</p><p><strong>Arguments</strong></p><ul><li><code>θ</code>: the maximum likelihood parameters of the model</li><li><code>K</code>: the reduced degree sequence</li><li><code>F</code>: the frequency of each degree in the degree sequence</li></ul><p>The function returns the log-likelihood of the reduced model. For the optimisation, this function will be used to generate an anonymous function associated with a specific model.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs"># Generic use:
julia&gt; θ = [1.0, 2.0, 3.0, 4.0, 5.0];

julia&gt; K = [1, 2, 3, 4, 5];

julia&gt; F = [1, 2, 3, 4, 5];

julia&gt; L_UBCM_reduced(θ, K, F)
-225.3065566905141</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/B4rtDC/MaxEntropyGraphs.jl/blob/7880474ed4b5160f482e74ad34aeca954766825e/src/Models/UBCM.jl#L140-L165">source</a></section><section><div><pre><code class="language-julia hljs">L_UBCM_reduced(m::UBCM)</code></pre><p>Return the log-likelihood of the UBCM model <code>m</code> based on the computed maximum likelihood parameters.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs"># Use with UBCM model:
julia&gt; G = MaxEntropyGraphs.Graphs.SimpleGraphs.smallgraph(:karate);

julia&gt; model = UBCM(G);

julia&gt; solve_model!(model);

julia&gt; L_UBCM_reduced(model)
-168.68325136302832</code></pre><p>See also <a href="#MaxEntropyGraphs.L_UBCM_reduced"><code>L_UBCM_reduced(::Vector, ::Vector, ::Vector)</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/B4rtDC/MaxEntropyGraphs.jl/blob/7880474ed4b5160f482e74ad34aeca954766825e/src/Models/UBCM.jl#L184-L203">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MaxEntropyGraphs.∇L_UBCM_reduced!" href="#MaxEntropyGraphs.∇L_UBCM_reduced!"><code>MaxEntropyGraphs.∇L_UBCM_reduced!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">∇L_UBCM_reduced!(∇L::Vector, θ::Vector, K::Vector, F::Vector, x::Vector)</code></pre><p>Compute the gradient of the log-likelihood of the reduced UBCM model using the exponential formulation (to maintain convexity).</p><p>For the optimisation, this function will be used togenerate an anonymous function associated with a specific model.  The gradient is non-allocating and will update pre-allocated vectors (<code>∇L</code> and <code>x</code>) for speed. </p><p><strong>Arguments</strong></p><ul><li><code>∇L</code>: the gradient of the log-likelihood of the reduced model</li><li><code>θ</code>: the maximum likelihood parameters of the model</li><li><code>K</code>: the reduced degree sequence</li><li><code>F</code>: the frequency of each degree in the degree sequence</li><li><code>x</code>: the exponentiated maximum likelihood parameters of the model ( xᵢ = exp(-θᵢ) )</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs"># Explicit use with UBCM model:
julia&gt; G = MaxEntropyGraphs.Graphs.SimpleGraphs.smallgraph(:karate);

julia&gt; model = UBCM(G);

julia&gt; ∇L = zeros(Real, length(model.θᵣ));

julia&gt; x  = zeros(Real, length(model.θᵣ));

julia&gt; ∇model_fun! = θ -&gt; ∇L_UBCM_reduced!(∇L, θ, model.dᵣ, model.f, x);

julia&gt; ∇model_fun!(model.θᵣ);
</code></pre><pre><code class="language-julia-repl hljs"># Use within optimisation.jl framework:
julia&gt; model = UBCM(MaxEntropyGraphs.Graphs.SimpleGraphs.smallgraph(:karate));

julia&gt; fun =  (θ, p) -&gt;  - L_UBCM_reduced(θ, model.dᵣ, model.f);

julia&gt; x  = zeros(Real, length(model.θᵣ)); # initialise gradient buffer

julia&gt; ∇fun! = (∇L, θ, p) -&gt; ∇L_UBCM_reduced!(∇L, θ, model.dᵣ, model.f, x); # define gradient

julia&gt; θ₀ = initial_guess(model); # initial condition

julia&gt; foo = MaxEntropyGraphs.Optimization.OptimizationFunction(fun, grad=∇fun!); # define target function 

julia&gt; prob  = MaxEntropyGraphs.Optimization.OptimizationProblem(foo, θ₀); # define the optimisation problem

julia&gt; method = MaxEntropyGraphs.OptimizationOptimJL.LBFGS(); # set the optimisation method

julia&gt; MaxEntropyGraphs.Optimization.solve(prob, method); # solve it
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/B4rtDC/MaxEntropyGraphs.jl/blob/7880474ed4b5160f482e74ad34aeca954766825e/src/Models/UBCM.jl#L212-L264">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MaxEntropyGraphs.∇L_UBCM_reduced_minus!" href="#MaxEntropyGraphs.∇L_UBCM_reduced_minus!"><code>MaxEntropyGraphs.∇L_UBCM_reduced_minus!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">∇L_UBCM_reduced_minus!(args...)</code></pre><p>Compute minus the gradient of the log-likelihood of the reduced UBCM model using the exponential formulation in order to maintain convexity. Used for optimisation in a non-allocating manner.</p><p>See also <a href="#MaxEntropyGraphs.∇L_UBCM_reduced!"><code>∇L_UBCM_reduced!</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/B4rtDC/MaxEntropyGraphs.jl/blob/7880474ed4b5160f482e74ad34aeca954766825e/src/Models/UBCM.jl#L287-L293">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MaxEntropyGraphs.UBCM_reduced_iter!" href="#MaxEntropyGraphs.UBCM_reduced_iter!"><code>MaxEntropyGraphs.UBCM_reduced_iter!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">UBCM_reduced_iter!(θ, K, F, x, G)</code></pre><p>Computer the next fixed-point iteration for the UBCM model using the exponential formulation in order to maintain convexity. The function will update pre-allocated vectors (<code>G</code> and <code>x</code>) for speed.</p><p><strong>Arguments</strong></p><ul><li><code>θ</code>: the maximum likelihood parameters of the model</li><li><code>K</code>: the reduced degree sequence</li><li><code>F</code>: the frequency of each degree in the degree sequence</li><li><code>x</code>: the exponentiated maximum likelihood parameters of the model ( xᵢ = exp(-θᵢ) ) (pre-allocated)</li><li><code>G</code>: the next fixed-point iteration for the UBCM model (pre-allocated)</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; model = UBCM(MaxEntropyGraphs.Graphs.SimpleGraphs.smallgraph(:karate));

julia&gt; G = zeros(eltype(model.θᵣ), length(model.θᵣ));

julia&gt; x = zeros(eltype(model.θᵣ), length(model.θᵣ));

julia&gt; UBCM_FP! = θ -&gt; UBCM_reduced_iter!(θ, model.dᵣ, model.f, x, G);

julia&gt; UBCM_FP!(initial_guess(model));
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/B4rtDC/MaxEntropyGraphs.jl/blob/7880474ed4b5160f482e74ad34aeca954766825e/src/Models/UBCM.jl#L315-L342">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MaxEntropyGraphs.set_xᵣ!-Tuple{UBCM}" href="#MaxEntropyGraphs.set_xᵣ!-Tuple{UBCM}"><code>MaxEntropyGraphs.set_xᵣ!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">set_xᵣ!(m::UBCM)</code></pre><p>Set the value of xᵣ to exp(-θᵣ) for the UBCM model <code>m</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/B4rtDC/MaxEntropyGraphs.jl/blob/7880474ed4b5160f482e74ad34aeca954766825e/src/Models/UBCM.jl#L461-L465">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MaxEntropyGraphs.Ĝ-Tuple{UBCM}" href="#MaxEntropyGraphs.Ĝ-Tuple{UBCM}"><code>MaxEntropyGraphs.Ĝ</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Ĝ(m::UBCM)</code></pre><p>Compute the expected adjacency matrix for the UBCM model <code>m</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/B4rtDC/MaxEntropyGraphs.jl/blob/7880474ed4b5160f482e74ad34aeca954766825e/src/Models/UBCM.jl#L475-L479">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MaxEntropyGraphs.set_Ĝ!-Tuple{UBCM}" href="#MaxEntropyGraphs.set_Ĝ!-Tuple{UBCM}"><code>MaxEntropyGraphs.set_Ĝ!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">set_Ĝ!(m::UBCM)</code></pre><p>Set the expected adjacency matrix for the UBCM model <code>m</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/B4rtDC/MaxEntropyGraphs.jl/blob/7880474ed4b5160f482e74ad34aeca954766825e/src/Models/UBCM.jl#L502-L506">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MaxEntropyGraphs.σˣ-Tuple{UBCM}" href="#MaxEntropyGraphs.σˣ-Tuple{UBCM}"><code>MaxEntropyGraphs.σˣ</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">σˣ(m::UBCM{T,N}) where {T,N}</code></pre><p>Compute the standard deviation for the elements of the adjacency matrix for the UBCM model <code>m</code>.</p><p><strong>Note:</strong> read as &quot;sigma star&quot;</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/B4rtDC/MaxEntropyGraphs.jl/blob/7880474ed4b5160f482e74ad34aeca954766825e/src/Models/UBCM.jl#L514-L520">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MaxEntropyGraphs.set_σ!-Tuple{UBCM}" href="#MaxEntropyGraphs.set_σ!-Tuple{UBCM}"><code>MaxEntropyGraphs.set_σ!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">set_σ!(m::UBCM)</code></pre><p>Set the standard deviation for the elements of the adjacency matrix for the UBCM model <code>m</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/B4rtDC/MaxEntropyGraphs.jl/blob/7880474ed4b5160f482e74ad34aeca954766825e/src/Models/UBCM.jl#L542-L546">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.precision-Tuple{UBCM}" href="#Base.precision-Tuple{UBCM}"><code>Base.precision</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">precision(m::UBCM)</code></pre><p>Determine the compute precision of the UBCM model <code>m</code>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; model = UBCM(MaxEntropyGraphs.Graphs.SimpleGraphs.smallgraph(:karate));

julia&gt; MaxEntropyGraphs.precision(model)
Float64</code></pre><pre><code class="language-julia-repl hljs">julia&gt; model = UBCM(MaxEntropyGraphs.Graphs.SimpleGraphs.smallgraph(:karate), precision=Float32);

julia&gt; MaxEntropyGraphs.precision(model)
Float32</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/B4rtDC/MaxEntropyGraphs.jl/blob/7880474ed4b5160f482e74ad34aeca954766825e/src/Models/UBCM.jl#L730-L749">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MaxEntropyGraphs.A-Tuple{UBCM, Int64, Int64}" href="#MaxEntropyGraphs.A-Tuple{UBCM, Int64, Int64}"><code>MaxEntropyGraphs.A</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">A(m::UBCM,i::Int,j::Int)</code></pre><p>Return the expected value of the adjacency matrix for the UBCM model <code>m</code> at the node pair <code>(i,j)</code>.</p><p>❗ For perfomance reasons, the function does not check:</p><ul><li>if the node pair is valid.</li><li>if the parameters of the model have been computed.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/B4rtDC/MaxEntropyGraphs.jl/blob/7880474ed4b5160f482e74ad34aeca954766825e/src/Models/UBCM.jl#L762-L770">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MaxEntropyGraphs.f_UBCM-Tuple{UBCM}" href="#MaxEntropyGraphs.f_UBCM-Tuple{UBCM}"><code>MaxEntropyGraphs.f_UBCM</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">f_UBCM(x::T)</code></pre><p>Helper function for the UBCM model to compute the expected value of the adjacency matrix. The function computes the expression <code>x / (1 + x)</code>. As an argument you need to pass the product of the maximum likelihood parameters <code>xᵣ[i] * xᵣ[j]</code> from a UBCM model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/B4rtDC/MaxEntropyGraphs.jl/blob/7880474ed4b5160f482e74ad34aeca954766825e/src/Models/UBCM.jl#L753-L758">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MaxEntropyGraphs.σₓ-Tuple{UBCM, Function}" href="#MaxEntropyGraphs.σₓ-Tuple{UBCM, Function}"><code>MaxEntropyGraphs.σₓ</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">σₓ(m::UBCM, X::function)</code></pre><p>Compute the standard deviation of metric <code>X</code> for the UBCM model <code>m</code>. </p><p>This requires that both the expected values (m.Ĝ) and standard deviations (m.σ) are computed for <code>m</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/B4rtDC/MaxEntropyGraphs.jl/blob/7880474ed4b5160f482e74ad34aeca954766825e/src/Models/UBCM.jl#L962-L968">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../API/">« Shared</a><a class="docs-footer-nextpage" href="../API_DBCM/">DBCM »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Wednesday 10 April 2024 08:44">Wednesday 10 April 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
